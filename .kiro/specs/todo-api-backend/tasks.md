# 実装計画

- [x] 1. プロジェクト構造とコア設定の作成





  - プロジェクトディレクトリ構造を作成し、基本的な設定ファイルを実装する
  - requirements.txt、Dockerfile、docker-compose.ymlを作成する
  - _要件: 4.1, 4.2, 4.3_

- [x] 2. データベース設定とモデルの実装




  - [x] 2.1 データベース接続設定の実装


    - SQLAlchemyを使用したデータベース接続設定を作成する
    - 環境変数による設定管理を実装する
    - _要件: 3.1, 3.3_

  - [x] 2.2 SQLAlchemyモデルの実装


    - Todoモデルをapp/models/todo.pyに実装する
    - テーブル作成とインデックス設定を含める
    - _要件: 2.1, 3.1, 3.2_

- [x] 3. Pydanticスキーマの実装




  - [x] 3.1 基本スキーマクラスの作成


    - TodoBase、TodoCreate、TodoUpdate、TodoResponseスキーマを実装する
    - バリデーションルールを設定する（タイトル最大200文字、説明最大1000文字）
    - _要件: 2.1, 2.2_

- [x] 4. リポジトリ層の実装




  - [x] 4.1 ToDoリポジトリの実装


    - CRUD操作を行うTodoRepositoryクラスを作成する
    - データベースセッション管理を実装する
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 3.2_

  - [x] 4.2 リポジトリのテスト作成


    - TodoRepositoryの単体テストを作成する
    - テストデータベースを使用したテストを実装する
    - _要件: 6.2, 6.3_

- [x] 5. サービス層の実装






  - [x] 5.1 ToDoサービスの実装

    - ビジネスロジックを含むTodoServiceクラスを作成する
    - エラーハンドリングとバリデーションを実装する
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 2.2, 2.3_

  - [x] 5.2 サービス層のテスト作成


    - TodoServiceの単体テストを作成する
    - モックを使用した依存関係のテストを実装する
    - _要件: 6.2_

- [x] 6. API層の実装





  - [x] 6.1 ヘルスチェックエンドポイントの実装


    - /healthエンドポイントを作成する
    - データベース接続状態の確認機能を実装する
    - _要件: 5.1, 5.2, 5.3_

  - [x] 6.2 ToDoエンドポイントの実装


    - POST /todos、GET /todos、GET /todos/{id}、PUT /todos/{id}、DELETE /todos/{id}エンドポイントを実装する
    - 適切なHTTPステータスコードとレスポンス形式を設定する
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 5.3_

  - [x] 6.3 エラーハンドリングの実装


    - カスタム例外ハンドラーを作成する
    - 404、422、500エラーの適切な処理を実装する
    - _要件: 2.2, 2.3, 3.3_

- [x] 7. FastAPIアプリケーションの統合





  - [x] 7.1 メインアプリケーションの作成


    - app/main.pyにFastAPIアプリケーションを作成する
    - ルーターの登録とミドルウェア設定を実装する
    - _要件: 4.2, 4.3, 5.1, 5.2, 5.3_

  - [x] 7.2 設定管理の実装


    - app/config.pyに環境変数による設定管理を実装する
    - データベースURL、ログレベルなどの設定を含める
    - _要件: 3.1, 3.3_

- [x] 8. APIテストの実装





  - [x] 8.1 統合テストの作成


    - 全APIエンドポイントの統合テストを作成する
    - テストクライアントを使用したエンドツーエンドテストを実装する
    - _要件: 6.1, 6.2_

  - [x] 8.2 テスト設定の実装


    - conftest.pyにテスト用フィクスチャを作成する
    - テストデータベースの設定を実装する
    - _要件: 6.3_

- [x] 9. Docker環境の構築





  - [x] 9.1 Dockerfileの最適化


    - Python 3.13-slimベースのDockerfileを作成する
    - マルチステージビルドとセキュリティ設定を実装する
    - _要件: 4.1, 4.2_

  - [x] 9.2 docker-compose設定の完成


    - アプリケーションとPostgreSQLの連携設定を完成させる
    - ボリューム設定とネットワーク設定を実装する
    - _要件: 4.1, 4.2, 4.3_

- [x] 10. プロジェクトドキュメントの作成




  - [x] 10.1 PlantUMLシーケンス図の作成


    - 各CRUD操作のシーケンス図を作成する
    - create_todo.puml、get_todos.puml、get_todo_by_id.puml、update_todo.puml、delete_todo.pumlを実装する
    - _要件: 7.1, 7.2, 7.3_



  - [x] 10.2 プロジェクトREADMEの作成





    - セットアップ手順、API仕様、開発ガイドラインを含むREADME.mdを作成する
    - Swagger UIへのアクセス方法とテスト実行方法を記載する
    - _要件: 4.2, 4.3, 5.1, 6.1_

- [x] 11. ToDoアイテム期限設定機能の実装




  - [x] 11.1 データモデルへのend_dateフィールド追加


    - SQLAlchemyモデルにend_dateカラムを追加する
    - 期限切れ判定のis_overdueプロパティを実装する
    - データベースインデックスを追加する
    - _要件: 7.1, 7.5_

  - [x] 11.2 Pydanticスキーマの更新


    - TodoBase、TodoUpdate、TodoResponseスキーマにend_dateフィールドを追加する
    - ISO 8601形式のバリデーションと説明を追加する
    - _要件: 7.1, 7.7_

  - [x] 11.3 リポジトリ層の更新


    - TodoRepositoryのcreateメソッドでend_dateフィールドを処理する
    - 既存のCRUD操作がend_dateフィールドに対応することを確認する
    - _要件: 7.1, 7.2, 7.3, 7.4_

  - [x] 11.4 期限設定機能のテスト実装


    - end_date機能専用のテストスイートを作成する
    - 期限付きタスクの作成・更新・削除テストを実装する
    - 期限切れ判定とバリデーションのテストを実装する
    - _要件: 7.1, 7.2, 7.3, 7.4, 7.5, 7.7_

  - [x] 11.5 API仕様書の更新


    - OpenAPI仕様にend_dateフィールドの詳細説明を追加する
    - Swagger UIでの使用例とISO 8601形式の説明を追加する
    - _要件: 7.1, 7.7_

  - [x] 11.6 データベースマイグレーション


    - 既存データベースにend_dateカラムを追加するマイグレーションスクリプトを作成する
    - マイグレーション実行手順のドキュメントを作成する
    - _要件: 7.1_

- [x] 12. 条件付きToDoアイテム検索機能の実装









  - [x] 12.1 検索用Pydanticスキーマの実装




    - TodoSearchParamsスキーマをapp/schemas/todo.pyに追加する
    - クエリパラメータのバリデーションルールを実装する
    - 日時範囲バリデーション（end_date_from <= end_date_to）を追加する
    - _要件: 8.6, 8.7, 8.8_

  - [x] 12.2 リポジトリ層の検索機能実装




    - TodoRepositoryにsearch_todosメソッドを追加する
    - completed、end_date_from、end_date_toによる条件検索を実装する
    - 複数条件の組み合わせ検索に対応する
    - ページネーション機能を含める
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5_

  - [x] 12.3 サービス層の検索機能実装




    - TodoServiceにsearch_todosメソッドを追加する
    - 検索パラメータのバリデーションを実装する
    - エラーハンドリングとログ記録を追加する
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8_

  - [x] 12.4 検索APIエンドポイントの実装




    - GET /todos/searchエンドポイントをapp/routers/todo.pyに追加する
    - クエリパラメータの受け取りと処理を実装する
    - 適切なHTTPステータスコードとエラーレスポンスを設定する
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8_

  - [x] 12.5 検索機能のテスト実装




    - 検索機能専用のテストケースを作成する
    - 各検索条件（completed、end_date_from、end_date_to）のテストを実装する
    - 複数条件組み合わせのテストを実装する
    - バリデーションエラーのテストを実装する
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8_

  - [x] 12.6 API仕様書の更新




    - OpenAPI仕様に検索エンドポイントの詳細を追加する
    - クエリパラメータの説明と使用例を追加する
    - Swagger UIでのテスト用サンプルを追加する
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5_

- [x] 13. 最終統合とテスト










  - [x] 13.1 全体テストの実行




    - 全ての単体テスト、統合テストを実行し、カバレッジを確認する
    - pytest設定を最適化し、テストレポートを生成する
    - _要件: 6.1, 6.2_

  - [x] 13.2 Docker環境での動作確認




    - docker-compose upでアプリケーションを起動する
    - Swagger UIでの動作確認とAPIテストを実行する
    - 検索機能の各ユースケース（期限切れタスク、今日中のタスク、完了済みタスク）を確認する
    - _要件: 4.1, 4.2, 4.3, 5.1, 5.2, 5.3, 8.1, 8.2, 8.3, 8.4, 8.5_